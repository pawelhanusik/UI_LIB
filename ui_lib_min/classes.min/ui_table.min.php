<?php namespace UI; ?>
<style>.ui_table, .ui_table_control {	border-collapse: collapse;	border: 2px solid #888;}.ui_table {	margin: auto;	width: 100%;	}.ui_table_control {	margin: auto 0 auto auto;	border-bottom: none;}.ui_table td, .ui_table th {	border: 1px solid #aaa;	text-align: center;	padding: 8px 12px;}.ui_table_control td, .ui_table_control th {	padding: 6px;}.ui_table_control td:first-child {	border-right: 2px solid #888;	cursor: pointer;}.ui_table tr:nth-child(even) {	background-color: #ddd;}.ui_table .colFitContents {	width: 1%;	white-space: nowrap;}.ui_table th a {  cursor: pointer;}.ui_table input{	width: 100%;}.ui_table_control input {	text-align: center;}</style>
<script>class UI_Table{constructor(t,e="ui_table",s="ui_table_control"){this.id=t,this.className=e,this.classNameControl=s,this.header=[],this.data=[],this.show_at_once=10,this.show_page_no=0,this.sorted_col=0,this.sorted_asc=1,this.filters_inputs_visibility=!1,this.filters=[],this.filteredData=[],this.filtersChanged=!1}drawIntoTableId(t=this.id){let e=document.getElementById(t),s=document.createElement("table");s.id=this.id,s.className=this.className;let i=document.createElement("table");i.id="",i.className=this.classNameControl;let a=document.createElement("tr");a.innerHTML=' \t\t\t<td onclick="'+this.id+'.change_filters_visibility();"><svg width="5mm" height="5mm" version="1.1" viewBox="0 0 90 90" xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g transform="translate(0,-207)"><path d="m83.436 207.58-38.757 67.734-39.28-67.431 39.019-0.15107z" stroke-width=".26458"/><g transform="matrix(1.0029 .047256 -.046672 1.015 -22.678 165)"><path d="m83.329 112.62-21.784 13.937-1.178-25.834 11.481 5.9485z" stroke-width=".26458"/></g><rect x="33.165" y="238.95" width="22.475" height="44.299" stroke-width=".26458"/></g></svg></td>\t\t\t\t\t\t<td><button onclick="'+this.id+'.prev_page();">&lt;</button></td> \t\t\t<td><input type="text" value="'+(this.show_page_no+1)+'" size="'+Math.max(Math.ceil(Math.log10(this.data.length/this.show_at_once))-1,1)+'" onkeyup="if(!isNaN(parseInt(this.value-1)))'+this.id+'.change_page(parseInt(this.value-1));"></td> \t\t\t<td><a> / </a></td> \t\t\t<td><a>'+Math.ceil(this.data.length/this.show_at_once)+'</a></td> \t\t\t<td><button onclick="'+this.id+'.next_page();">&gt;</button></td> \t\t',i.appendChild(a),e.appendChild(i),e.appendChild(s),s.appendChild(document.createElement("tr"));for(let t=0;t<this.header.length;++t){let e="";e+='<a onclick="'+s.id+".sort("+t+').updateTable()">',e+=this.header[t],this.sorted_col===t&&(e+=1===this.sorted_asc?" &#x25BD;":" &#x25B3;"),e+="</a>",e+='<input type="text" style="display: none;" value="'+this.get_filter(t)+'" onchange="'+this.id+".setFilter("+t+", this.value); "+this.id+'.updateTable();">';let i=document.createElement("th");i.innerHTML=e,s.rows[0].appendChild(i)}this.filteredData=this.data;for(let t=0;t<Math.min(this.data.length,this.show_at_once);++t){s.appendChild(document.createElement("tr"));for(let e=0;e<this.data[t].length;++e){let i=document.createElement("td");i.innerHTML=this.data[t][e],s.rows[t+1].appendChild(i)}}}next_page(){this.change_page(this.show_page_no+1)}prev_page(){this.change_page(this.show_page_no-1)}change_page(t){t>=0&&t<Math.ceil(this.filteredData.length/this.show_at_once)&&(this.show_page_no=t,this.updateTable())}change_filters_visibility(){this.filters_inputs_visibility=!this.filters_inputs_visibility,this.filter_inputs_show(this.filters_inputs_visibility)}filter_inputs_show(t){let e="",s=document.getElementById(this.id).getElementsByTagName("table")[0].getElementsByTagName("td")[0];t?s.style.backgroundColor="#0002":(e="none",s.style.backgroundColor="");let i=document.getElementById(this.id).getElementsByTagName("table")[1];for(let t of i.rows[0].cells){let s=t.getElementsByTagName("input")[0];void 0!==s&&(s.style.display=e)}}get_filter(t){return null==this.filters[t]?"":this.filters[t]}sort(t){this.sorted_col===t?this.sorted_asc*=-1:(this.sorted_col=t,this.sorted_asc=1);let e=this.sorted_asc;return this.data.sort(function(s,i){let a=parseInt(s[t]),l=parseInt(i[t]);return(isNaN(a)||isNaN(l))&&(a=s[t],l=i[t]),a>l?1*e:a<l?-1*e:0}),this}filter(){if(this.filtersChanged){this.filtersChanged=!1,this.filteredData=[];for(let t=0;t<this.data.length;++t){let e=!0;for(let s=0;s<this.filters.length;++s)if(void 0!==this.filters[s]&&-1===this.data[t][s].indexOf(this.filters[s])){e=!1;break}e&&this.filteredData.push(this.data[t])}}}setFilter(t,e){this.filters[t]=""==e?void 0:e,this.filtersChanged=!0,this.show_page_no=0}updateTable(){let t=document.getElementById(this.id).getElementsByTagName("table")[0];t.getElementsByTagName("input")[0].value=this.show_page_no+1;let e=document.getElementById(this.id).getElementsByTagName("table")[1];for(e.className=this.className;this.header.length-e.rows[0].cells.length>0;)e.rows[0].appendChild(document.createElement("th"));for(;this.header.length-e.rows[0].cells.length<0;)e.rows[0].cells[0].remove();for(let t=0;t<this.header.length;++t){let s="";s+='<a onclick="'+e.id+".sort("+t+').updateTable()">',s+=this.header[t],this.sorted_col===t&&(s+=1===this.sorted_asc?" &#x25BD;":" &#x25B3;"),s+="</a>",s+='<input type="text"'+(this.filters_inputs_visibility?"":' style="display: none;" ')+'value="'+this.get_filter(t)+'" onchange="'+this.id+".setFilter("+t+", this.value); "+this.id+'.updateTable();">',e.rows[0].cells[t].innerHTML=s}this.filter();let s=this.show_page_no*this.show_at_once,i=Math.min(this.filteredData.length-s,this.show_at_once);for(;i-e.rows.length+1>0;)e.appendChild(document.createElement("tr"));for(;i-e.rows.length+1<0;)e.rows[1].remove();for(let t=s;t<Math.min(this.filteredData.length,s+this.show_at_once);++t){for(;this.filteredData[t].length-e.rows[t+1-s].cells.length>0;)e.rows[t+1-s].appendChild(document.createElement("td"));for(;this.filteredData[t].length-e.rows[t+1-s].cells.length<0;)e.rows[t+1-s].cells[0].remove();for(let i=0;i<this.filteredData[t].length;++i)e.rows[t+1-s].cells[i].innerHTML=this.filteredData[t][i]}t.getElementsByTagName("td")[4].innerHTML="<a>"+Math.ceil(this.filteredData.length/this.show_at_once)+"</a>"}}</script>
<?php class Table{private $table_id;private $className='ui_table classic';public $head=array();public $data=array();private $show_at_once=100;public function __construct(){static $tmp_table_id=0;++$tmp_table_id;$this->table_id='ui_table_'.$tmp_table_id;}public function show($amount){$this->show_at_once=$amount;}public function draw(){ ?><div id="<?php echo $this->table_id; ?>"></div><script>var <?php echo $this->table_id; ?>=new UI_Table("<?php echo $this->table_id; ?>","<?php echo $this->className; ?>");<?php echo $this->table_id; ?>.show_at_once=<?php echo $this->show_at_once; ?>;<?php echo $this->table_id; ?>.header=[<?php if(is_array($this->head)){for($i=0;$i<count($this->head); ++$i){if($i>0)echo ',';echo '"'.$this->head[$i].'"';}} ?>];<?php echo $this->table_id; ?>.data=[<?php if(is_array($this->data)){for($i=0; $i<count($this->data);++$i){$dataRow=$this->data[$i];if($i>0)echo ',';echo '[';if(is_array($dataRow)){for($j=0;$j<count($dataRow);++$j){if($j>0)echo ',';echo '"'.$dataRow[$j].'"';}}echo ']';}} ?>];<?php echo $this->table_id; ?>.drawIntoTableId();</script><?php }public function setHeader($header){$this->head=$header;}public function addRow($row){$this->data[]=$row;}} ?>